(window.webpackJsonpmyreads=window.webpackJsonpmyreads||[]).push([[0],{27:function(e,t,a){e.exports=a(39)},32:function(e,t,a){},33:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(22),s=a.n(r),c=(a(32),a(8)),l=a(9),i=a(12),h=a(11),u=a(13),k=a(18),d="https://reactnd-books-api.udacity.com",m=localStorage.token;m||(m=localStorage.token=Math.random().toString(36).substr(-8),console.log("token:",m));var f={Accept:"application/json",Authorization:m},b=(a(33),a(26)),v=a(6),p=a(23),g=a.n(p),S=a(10),B=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(h.a)(t).call(this,e))).state={bookShelf:a.props.book.shelf?a.props.book.shelf:"none"},a.handleChange=a.handleChange.bind(Object(S.a)(a)),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"handleChange",value:function(e){this.setState({bookShelf:e.target.value},(function(){this.props.changeBookShelf(this.props.book,this.state.bookShelf)}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"book-shelf-changer"},n.a.createElement("select",{value:this.state.bookShelf,onChange:this.handleChange},n.a.createElement("option",{value:"move",disabled:"disabled"},"Move to..."),n.a.createElement("option",{value:"currentlyReading",disabled:"currentlyReading"===this.state.bookShelf||null},"Currently Reading"),n.a.createElement("option",{value:"wantToRead",disabled:"wantToRead"===this.state.bookShelf||null},"Want to Read"),n.a.createElement("option",{value:"read",disabled:"read"===this.state.bookShelf||null},"Read"),n.a.createElement("option",{value:"none",disabled:"currentlyReading"!==this.state.bookShelf&&"wantToRead"!==this.state.bookShelf&&"read"!==this.state.bookShelf||null},"None")))}}]),t}(o.Component);var E=function(e){var t=e.book,a=e.changeBookShelf;return void 0!==t?n.a.createElement("div",{className:"book"},n.a.createElement("div",{className:"book-top"},n.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:"url(".concat(t.imageLinks&&t.imageLinks.smallThumbnail||"../public/book.jpg",")")}}),n.a.createElement(B,{book:t,changeBookShelf:a})),n.a.createElement("div",{className:"book-title"},t.title),t.authors?t.authors.length>1?t.authors.map((function(e){return n.a.createElement("div",{key:e,className:"book-authors"},e)})):n.a.createElement("div",{className:"book-authors"},t.authors):n.a.createElement("div",{className:"book-authors"},"Unknown")):n.a.createElement("div",null)};var y=function(e){var t=e.books,a=e.changeBookShelf;return n.a.createElement("ol",{className:"books-grid"},t&&t.map((function(e,t){return n.a.createElement("li",{key:t},n.a.createElement(E,{book:e,changeBookShelf:a}))})))};var j=function(e){var t=e.name,a=e.shelfBooks,o=e.changeBookShelf;return n.a.createElement("div",{className:"bookshelf"},n.a.createElement("h2",{className:"bookshelf-title"},"currentlyReading"===t?"Currently Reading":"wantToRead"===t?"Want To Read":"read"===t?"Read":t),n.a.createElement("div",{className:"bookshelf-books"},n.a.createElement(y,{books:a,changeBookShelf:o})))};var C=function(e){var t=e.books,a=e.changeBookShelf,o={currentlyReading:1,wantToRead:2,read:3};t.sort((function(e,t){return o[e.shelf]-o[t.shelf]}));var r=Object.entries(g.a.groupBy(t,"shelf")).map((function(e){var t=Object(b.a)(e,2),o=t[0],r=t[1];return n.a.createElement("div",{key:o},n.a.createElement(j,{name:o,shelfBooks:r,changeBookShelf:a}))}));return n.a.createElement("div",{className:"list-books"},n.a.createElement("div",{className:"list-books-title"},n.a.createElement("h1",null,"My Reads")),n.a.createElement("div",{className:"list-books-content"},n.a.createElement("div",null,r)),n.a.createElement("div",{className:"open-search"},n.a.createElement(v.b,{to:"/search"},"Add a book")))},N=a(5),O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(h.a)(t).call(this,e))).handleClick=function(e){a.props.clearSearchBooks()},a.state={searchTerm:""},a.onChange=a.onChange.bind(Object(S.a)(a)),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onChange",value:function(e){var t=e.target.value.toLowerCase();this.setState({searchTerm:t},(function(){void 0!==t&&t.length>0?this.props.searchBooks(t):this.props.clearSearchBooks()}))}},{key:"renderSearchedBooks",value:function(){return this.props.filteredBooks.length>0?n.a.createElement("div",{className:"search-books-results"},n.a.createElement(y,{books:this.props.filteredBooks,changeBookShelf:this.props.changeBookShelf})):this.state.searchTerm.length>0?n.a.createElement("div",{className:"search-books-results"},n.a.createElement("h4",null,'No result found for: "',this.state.searchTerm,'"')):void 0}},{key:"render",value:function(){return n.a.createElement("div",{className:"search-books"},n.a.createElement("div",{className:"search-books-bar"},n.a.createElement(v.b,{to:"/",className:"close-search",onClick:this.handleClick.bind(this)},"Close"),n.a.createElement("div",{className:"search-books-input-wrapper"},n.a.createElement("input",{type:"text",onChange:this.onChange,placeholder:"Search by title or author"}))),this.renderSearchedBooks())}}]),t}(o.Component),w=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(h.a)(t).call(this,e))).componentDidMount=function(){a.getAllBooksFromAPI()},a.onChangeBookShelf=function(e,t){(function(e,t){return fetch("".concat(d,"/books/").concat(e.id),{method:"PUT",headers:Object(k.a)({},f,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then((function(e){return e.json()}))})(e,t).then((function(e){})).catch((function(e){console.log(e),a.setState({error:!0})})),"none"===t?a.setState((function(t){return{myBooks:t.myBooks.filter((function(t){return t.id!==e.id}))}})):(e.shelf=t,a.setState((function(t){return{myBooks:t.myBooks.filter((function(t){return t.id!==e.id})).concat(e)}})))},a.onSearchBooks=function(e){var t,o;(t=e,o=10,fetch("".concat(d,"/search"),{method:"POST",headers:Object(k.a)({},f,{"Content-Type":"application/json"}),body:JSON.stringify({query:t,maxResults:o})}).then((function(e){return e.json()})).then((function(e){return e.books}))).then((function(e){if(Array.isArray(e)){var t=e.map((function(e){return a.state.myBooks.map((function(t){return t.id===e.id&&(e.shelf=t.shelf),t})),e}));a.setState({searchBooks:t})}else a.setState({searchBooks:[]})})).catch((function(e){console.log(e),a.setState({error:!0})}))},a.onClearSearchBooks=function(){a.setState({searchBooks:[]})},a.state={myBooks:[],searchBooks:[],error:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"getAllBooksFromAPI",value:function(){var e=this;fetch("".concat(d,"/books"),{headers:f}).then((function(e){return e.json()})).then((function(e){return e.books})).then((function(t){e.setState({myBooks:t})})).catch((function(t){console.log(t),e.setState({error:!0})}))}},{key:"render",value:function(){var e=this;return this.state.error?n.a.createElement("div",null,"An error occured. Please, try again later."):n.a.createElement("div",{className:"app"},n.a.createElement(N.a,{exact:!0,path:"/",render:function(){return n.a.createElement(C,{books:e.state.myBooks,changeBookShelf:e.onChangeBookShelf})}}),n.a.createElement(N.a,{path:"/search",render:function(){return n.a.createElement(O,{filteredBooks:e.state.searchBooks,myReadBooks:e.state.myBooks,changeBookShelf:e.onChangeBookShelf,searchBooks:e.onSearchBooks,clearSearchBooks:e.onClearSearchBooks})}}))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(v.a,{basename:"/myreads"},n.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.c7c03576.chunk.js.map